<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WinTradesGo Control Panel</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            text-align: center;
            max-width: 600px;
            width: 100%;
        }
        
        .header {
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 16px;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .control-btn {
            padding: 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: white;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .start-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .stop-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .status-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .status-panel {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .online { background: #27ae60; }
        .offline { background: #e74c3c; }
        .checking { background: #f39c12; }
        
        .quick-links {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        .quick-links a {
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 16px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        
        .quick-links a:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        .instructions {
            background: #e8f4f8;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
        }
        
        .instructions h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            color: #5d6d7e;
            line-height: 1.6;
        }
        
        .log-area {
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            height: 150px;
            overflow-y: auto;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ WinTradesGo Control Panel</h1>
            <p>Visual Server Management Interface</p>
        </div>
        
        <div class="button-grid">
            <button class="control-btn start-btn" onclick="startServer()">
                <span>üéØ</span> Start Server
            </button>
            <button class="control-btn restart-btn" onclick="restartServer()">
                <span>üîÑ</span> Restart Server
            </button>
            <button class="control-btn stop-btn" onclick="stopServer()">
                <span>üõë</span> Stop Server
            </button>
            <button class="control-btn status-btn" onclick="checkStatus()">
                <span>üìä</span> Check Status
            </button>
        </div>
        
        <div class="status-panel">
            <h3>üìä System Status</h3>
            <div id="frontend-status">
                <span class="status-indicator checking"></span>
                Frontend (Vite): Checking...
            </div>
            <div id="backend-status" style="margin-top: 10px;">
                <span class="status-indicator checking"></span>
                Backend (API): Checking...
            </div>
            
            <div class="quick-links">
                <a href="http://localhost:5173" target="_blank">üì± Open Dashboard</a>
                <a href="http://localhost/wintradesgo/model-api.php?action=get_features" target="_blank">üîß Test API</a>
            </div>
        </div>
        
        <div class="log-area" id="log-area">
            <div>WinTradesGo Control Panel Initialized</div>
            <div>Ready to manage your trading system...</div>
        </div>
        
        <div class="instructions">
            <h3>üìù How to Use:</h3>
            <ul>
                <li><strong>Start Server:</strong> Downloads and runs start-server.bat</li>
                <li><strong>Restart Server:</strong> Downloads and runs crash-recovery.bat</li>
                <li><strong>Stop Server:</strong> Shows instructions to stop services</li>
                <li><strong>Check Status:</strong> Tests if servers are responding</li>
            </ul>
        </div>
    </div>

    <script>
        let logArea = document.getElementById('log-area');
        
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${timestamp}] ${message}`;
            logArea.appendChild(logEntry);
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function updateStatus(service, status) {
            const element = document.getElementById(`${service}-status`);
            const indicator = element.querySelector('.status-indicator');
            
            indicator.className = `status-indicator ${status}`;
            
            const statusText = {
                online: '‚úÖ Running',
                offline: '‚ùå Stopped', 
                checking: '‚è≥ Checking...'
            };
            
            element.innerHTML = `
                <span class="status-indicator ${status}"></span>
                ${service === 'frontend' ? 'Frontend (Vite)' : 'Backend (API)'}: ${statusText[status]}
            `;
        }
        
        function downloadAndRun(filename, description) {
            addLog(`Preparing to ${description}...`);
            
            // Create download link
            const link = document.createElement('a');
            link.href = `./${filename}`;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            addLog(`Downloaded ${filename} - Please run it to ${description}`);
            
            // Show user instructions
            setTimeout(() => {
                alert(`üì• Downloaded: ${filename}\n\n` +
                      `üìç Location: Downloads folder\n\n` +
                      `‚ñ∂Ô∏è Action: Double-click the downloaded file to ${description}\n\n` +
                      `üí° Tip: You can also run it directly from the project folder`);
            }, 500);
        }
        
        function startServer() {
            downloadAndRun('start-server.bat', 'start the server');
        }
        
        function restartServer() {
            downloadAndRun('crash-recovery.bat', 'restart/recover the server');
        }
        
        function stopServer() {
            addLog('Stop server requested');
            alert('üõë To Stop WinTradesGo Server:\n\n' +
                  '1Ô∏è‚É£ Close the black terminal window (Vite server)\n' +
                  '2Ô∏è‚É£ Open XAMPP Control Panel ‚Üí Stop Apache\n' +
                  '3Ô∏è‚É£ Or run crash-recovery.bat to force stop all\n\n' +
                  'üí° Tip: The crash-recovery tool can force-stop everything');
        }
        
        async function checkStatus() {
            addLog('Checking system status...');
            updateStatus('frontend', 'checking');
            updateStatus('backend', 'checking');
            
            // Check frontend (Vite)
            try {
                const response = await fetch('http://localhost:5173', { 
                    mode: 'no-cors',
                    timeout: 5000 
                });
                updateStatus('frontend', 'online');
                addLog('‚úÖ Frontend: Online');
            } catch (error) {
                updateStatus('frontend', 'offline');
                addLog('‚ùå Frontend: Offline');
            }
            
            // Check backend (API)
            try {
                const response = await fetch('http://localhost/wintradesgo/model-api.php?action=get_features', {
                    mode: 'cors'
                });
                if (response.ok) {
                    updateStatus('backend', 'online');
                    addLog('‚úÖ Backend API: Online');
                } else {
                    throw new Error('API not responding');
                }
            } catch (error) {
                updateStatus('backend', 'offline');
                addLog('‚ùå Backend API: Offline');
            }
        }
        
        // Auto-check status on page load and every 30 seconds
        checkStatus();
        setInterval(checkStatus, 30000);
        
        // Welcome message
        addLog('Control panel ready');
        addLog('Use buttons above to manage your server');
    </script>
</body>
</html>